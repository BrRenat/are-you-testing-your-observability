import { CodeSurfer, CodeSurferColumns, Step } from "code-surfer";
import { Head, Notes } from "mdx-deck";
import { github, vsDark, shadesOfPurple } from "@code-surfer/themes";

export const theme = shadesOfPurple;

# Are you testing your Observability? üëã

<Notes>Create speaker notes with the Notes component</Notes>

---

# What is observability ‚õ∑

<Notes>Create speaker notes with the Notes component</Notes>

---

## Why Prometheus? üéø

<Notes>Create speaker notes with the Notes component</Notes>

---

## Signals üèÇ

<Notes>Create speaker notes with the Notes component</Notes>

---

## Metrics are essential ‚òÉÔ∏è

<Notes>Create speaker notes with the Notes component</Notes>

---

## Prometheus - How to expose? ‚ùÑÔ∏è

<Notes>Create speaker notes with the Notes component</Notes>

---

<CodeSurfer>

```go title="This is a title" subtitle="and this a subtitle"
    // Register standard Go metric collectors, which are by default registered when using global registry.
	reg.MustRegister(
		prometheus.NewGoCollector(),
		prometheus.NewProcessCollector(prometheus.ProcessCollectorOpts{}),
        func() float64 { return float64(*maxObjectsCount) }),
	)
```

```go title="This is a title" subtitle="and this a subtitle" 1 5:8,9[1:10]
    // Register standard Go metric collectors, which are by default registered when using global registry.
	reg.MustRegister(
		prometheus.NewGoCollector(),
		prometheus.NewProcessCollector(prometheus.ProcessCollectorOpts{}),
		prometheus.NewGaugeFunc(prometheus.GaugeOpts{
			Namespace: namespace,
			Name:      "configured_max_objects",
			Help:      "Configured maximum number of objects cache can take.",
		}, func() float64 { return float64(*maxObjectsCount) }),
	)
```

</CodeSurfer>

<Notes>Create speaker notes with the Notes component</Notes>

---

<CodeSurfer>

```go
    mux.Handle("/metrics", promhttp.HandlerFor(reg, promhttp.HandlerOpts{}))
    mux.Handle("/set", http.HandlerFunc(c.SetHandler))
    mux.Handle("/get", http.HandlerFunc(c.GetHandler))
```

```diff 1 subtitle="metrics"

```

```diff 2 subtitle="set"

```

```diff 3 subtitle="get"

```

</CodeSurfer>

<Notes>Create speaker notes with the Notes component</Notes>

---

## Holy battle; pull vs push

<Notes>Create speaker notes with the Notes component</Notes>

---

## Instrumenting Go applications

<Notes>Create speaker notes with the Notes component</Notes>

---

## Common pitfalls

<Notes>Create speaker notes with the Notes component</Notes>

---

## Globals

<Notes>Create speaker notes with the Notes component</Notes>

---

## Intro: define metric; register; expose HTTP; usage

<Notes>Create speaker notes with the Notes component</Notes>

---

## Problems: terrible for libs

<Notes>Create speaker notes with the Notes component</Notes>

---

## Solution: custom registered

<Notes>Create speaker notes with the Notes component</Notes>

---

## Counter vs Gauges

<Notes>Create speaker notes with the Notes component</Notes>

---

## Problems ??

<Notes>Create speaker notes with the Notes component</Notes>

---

## Queue size vs added/removed?

<Notes>Create speaker notes with the Notes component</Notes>

---

## Gauge, reset etc loss of info

<Notes>Create speaker notes with the Notes component</Notes>

---

## Histogram vs Summaries

<Notes>Create speaker notes with the Notes component</Notes>

---

## Yolo histogram buckets

<Notes>Create speaker notes with the Notes component</Notes>

---

## Not SLO based

<Notes>Create speaker notes with the Notes component</Notes>

---

## Random string in labels

<Notes>Create speaker notes with the Notes component</Notes>

---

## No Testing

<Notes>Create speaker notes with the Notes component</Notes>

---

## Hardcoding namespace in libraries/package

<Notes>Create speaker notes with the Notes component</Notes>

---

## WrapRegisterer

<Notes>Create speaker notes with the Notes component</Notes>

---

## Not using middlewares

<Notes>Create speaker notes with the Notes component</Notes>

---

## Solution:

<Notes>Create speaker notes with the Notes component</Notes>

---

## Reuse internally

<Notes>Create speaker notes with the Notes component</Notes>

---

## Convention/reuse dashboards; mixins!

<Notes>Create speaker notes with the Notes component</Notes>

---

## ~~Q/A~~
# Discussion

<Notes>Create speaker notes with the Notes component</Notes>

---

docs:

# TODO
